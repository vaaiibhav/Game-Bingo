<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>测试应用</title>
</head>
<style type="text/css">
    @import url(printer.css); /*这里是通过@import引用CSS的样式内容*/
</style>
<body>
<div id="main-div"></div>
<script src="libs/JsBarcode.all.min.js"></script>
<script src="libs/qrcode.min.js"></script>
<script src="libs/jquery.min.js"></script>
<script>
    var ipcRenderer = require('electron').ipcRenderer;
    var body = $('#main-div');
    var barcodeNo = 0;
    ipcRenderer.on('print-body-init', function (event, arg) {
        var css = arg.css;
        if(css){
            for(var key in css){
                var item = css[key];
                body.css(key,item);
            }
        }
        event.sender.send('print-body-init-reply', arg);
    });


    ipcRenderer.on('print-text', function (event, arg) {
        var text = arg.value;
        var css = arg.css;
        var div = $(`<div class="font" style="${arg.style}">${text}</div>`);
        if(css){
            for(var key in css){
                var item = css[key];
                div.css(key,item);
            }
        }
        body.append(div);
        event.sender.send('print-text-reply', arg);
    });


    ipcRenderer.on('print-qrcode', function (event, arg) {
        body.append(`<div id="qrcode${barcodeNo}" style="${arg.style}"></div>`);
        new QRCode(document.getElementById(`qrcode${barcodeNo}`), {
            text: arg.value,
            width: arg.width,
            height: arg.height,
            colorDark: "#000000",
            colorLight: "#ffffff",
            correctLevel: QRCode.CorrectLevel.H
        });
//        $(`#qrcode${barcodeNo}`).attr('style',arg.style);
        barcodeNo++;
        event.sender.send('print-qrcode-reply', arg);
    });

    ipcRenderer.on('print-barcode', function (event, arg) {
        body.append(`<img class="barcode${barcodeNo}"  style="${arg.style}"
        jsbarcode-value="${arg.value}"
        jsbarcode-width="${arg.width}"
        jsbarcode-height="${arg.height}"
        jsbarcode-fontsize="${arg.fontsize}"
        jsbarcode-margin="0"
        jsbarcode-displayvalue="${arg.displayValue}"/>`);
        JsBarcode(`.barcode${barcodeNo}`).init();
        barcodeNo++;
        event.sender.send('print-barcode-reply', arg);
    });
</script>
</body>
</html>